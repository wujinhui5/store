"use strict";(self["webpackChunkstore"]=self["webpackChunkstore"]||[]).push([[319],{8751:function(t,o,e){e.d(o,{B1:function(){return i},EL:function(){return f},Xd:function(){return p},aH:function(){return n},bx:function(){return a},c_:function(){return l},hq:function(){return u},jo:function(){return c},mL:function(){return h},pj:function(){return d},xZ:function(){return r},zJ:function(){return m}});var s=e(3872);function n(t){return(0,s.Z)({method:"post",url:"/get/shop/info",data:t})}function l(){return(0,s.Z)({method:"post",url:"/get/shops"})}function a(t){return(0,s.Z)({method:"post",url:"/get/shop/sort",data:t})}function u(){return(0,s.Z)({method:"post",url:"/get/slide"})}function r(t){return(0,s.Z)({method:"post",url:"/get/shop/car",data:t})}function c(t){return(0,s.Z)({method:"post",url:"/get/shop/delete",data:t})}function h(t){return(0,s.Z)({method:"post",url:"/get/shop/add",data:t})}function d(t){return(0,s.Z)({method:"post",url:"/get/settle",data:t})}function p(t){return(0,s.Z)({method:"post",url:"/get/order",data:t})}function i(t){return(0,s.Z)({method:"post",url:"/order/confirm",data:t})}function m(t){return(0,s.Z)({method:"post",url:"/order/refund",data:t})}function f(t){return(0,s.Z)({method:"post",url:"/order/cancal/refund",data:t})}},5643:function(t,o,e){e.d(o,{Z:function(){return i}});var s=e(3396),n=e(7139);const l={class:"img fl"},a=["src"],u={class:"title fl"};function r(t,o,e,r,c,h){const d=(0,s.up)("router-link");return(0,s.wg)(),(0,s.j4)(d,{class:"small-shop-box",to:{path:"/shop",query:e.query}},{default:(0,s.w5)((()=>[(0,s._)("div",l,[(0,s._)("img",{src:e.imgUrl},null,8,a)]),(0,s._)("span",u,(0,n.zw)(e.title),1)])),_:1},8,["to"])}var c=e(4870),h={props:{query:{type:Object},imgUrl:{type:String},title:{type:String}},setup(t){return{...(0,c.BK)(t)}}},d=e(89);const p=(0,d.Z)(h,[["render",r],["__scopeId","data-v-4e02a434"]]);var i=p},3432:function(t,o,e){e.r(o),e.d(o,{default:function(){return st}});var s=e(3396);const n={class:"login-up"};function l(t,o,e,l,a,u){const r=(0,s.up)("TopNav"),c=(0,s.up)("ShopCarHeader"),h=(0,s.up)("ShopsList"),d=(0,s.up)("AppFooter");return(0,s.wg)(),(0,s.iD)("div",n,[(0,s.Wm)(r),(0,s.Wm)(c),(0,s.Wm)(h),(0,s.Wm)(d)])}var a=e(2252);const u={class:"store-header"},r={class:"w"};function c(t,o,e,n,l,a){const c=(0,s.up)("AppLogo"),h=(0,s.up)("HeaderSearch");return(0,s.wg)(),(0,s.iD)("div",u,[(0,s._)("div",r,[(0,s.Wm)(c),(0,s.Wm)(h)])])}var h=e(8084),d=e(1966),p={components:{AppLogo:h.Z,HeaderSearch:d.Z}},i=e(89);const m=(0,i.Z)(p,[["render",c],["__scopeId","data-v-f08a44f8"]]);var f=m,C=e(7139),I=e(9242);const _=t=>((0,s.dD)("data-v-50e7397a"),t=t(),(0,s.Cn)(),t),g={class:"shops-list"},k={class:"all-box"},v=_((()=>(0,s._)("span",null,"全部商品 ",-1))),w={class:"all"},y=_((()=>(0,s._)("td",null,"商品",-1))),S=_((()=>(0,s._)("td",null,"单价",-1))),b=_((()=>(0,s._)("td",null,"数量",-1))),Z=_((()=>(0,s._)("td",null,"小计",-1))),x=_((()=>(0,s._)("td",null,"操作",-1))),U={class:"store"},A=["onUpdate:modelValue","onClick"],N=["onUpdate:modelValue","onClick"],z={class:"num-box"},H=["onClick"],j=["onUpdate:modelValue","onKeyup"],D=["onClick"],q={class:"total"},E=["onClick"],V={class:"settle-acount-entrance"},W={class:"fl"},O={class:"checkbox-box"},L={class:"total-price fr"},T={class:"but-settle-acount fr"},J={key:1,class:"tip"},K=_((()=>(0,s._)("h2",{class:"title"},"当前购物车没有商品！",-1)));function B(t,o,e,n,l,a){const u=(0,s.up)("SmallShopBox"),r=(0,s.up)("router-link");return(0,s.wg)(),(0,s.iD)("div",g,[0!=n.data.shops?((0,s.wg)(),(0,s.iD)(s.HY,{key:0},[(0,s._)("div",k,[v,(0,s._)("span",w,(0,C.zw)(n.totalShops),1)]),(0,s._)("table",null,[(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("td",null,[(0,s.wy)((0,s._)("input",{type:"checkbox",class:"checkbox","onUpdate:modelValue":o[0]||(o[0]=t=>n.data.allIsChoose=t),onClick:o[1]||(o[1]=(...t)=>n.changeAllIsChoose&&n.changeAllIsChoose(...t))},null,512),[[I.e8,n.data.allIsChoose]]),(0,s.Uk)(" 全选 ")]),y,S,b,Z,x])]),(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.data.shops,((t,o)=>((0,s.wg)(),(0,s.iD)(s.HY,{key:o},[(0,s._)("tr",U,[(0,s._)("td",null,[(0,s.wy)((0,s._)("input",{type:"checkbox",class:"checkbox","onUpdate:modelValue":t=>n.data.storeIsChoose[o]=t,onClick:t=>n.changeIsChoose(o)},null,8,A),[[I.e8,n.data.storeIsChoose[o]]])]),(0,s._)("td",null,(0,C.zw)(t.storeName),1)]),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(t.data,((e,l)=>((0,s.wg)(),(0,s.iD)("tr",{class:"shop-box",key:l},[(0,s._)("td",null,[(0,s.wy)((0,s._)("input",{type:"checkbox",class:"checkbox","onUpdate:modelValue":t=>n.data.shopIsChoose[o][l]=t,onClick:t=>n.changeShopIsChoose(o,l)},null,8,N),[[I.e8,n.data.shopIsChoose[o][l]]])]),(0,s._)("td",null,[(0,s.Wm)(u,{title:e.title,imgUrl:e.imgUrl,query:{storeId:t.storeId,shopId:e.shopId}},null,8,["title","imgUrl","query"])]),(0,s._)("td",null,"￥"+(0,C.zw)(e.price),1),(0,s._)("td",null,[(0,s._)("div",z,[(0,s._)("button",{class:"but-minus fl",onClick:t=>n.minusNum(o,l),style:(0,C.j5)(1===e.num?{color:"#ccc",cursor:"not-allowed"}:{})}," - ",12,H),(0,s.wy)((0,s._)("input",{type:"text","onUpdate:modelValue":t=>e.num=t,class:"fl",onKeyup:t=>n.inspectNum(o,l)},null,40,j),[[I.nr,e.num]]),(0,s._)("button",{class:"but-add fl",onClick:t=>n.addNum(o,l),style:(0,C.j5)(200===e.num?{color:"#ccc",cursor:"not-allowed"}:{})}," + ",12,D)])]),(0,s._)("td",q,"￥"+(0,C.zw)(e.price*e.num),1),(0,s._)("td",{class:"but-delete",onClick:t=>n.deleteShop(e.shopId)},"删除",8,E)])))),128))],64)))),128))])]),(0,s._)("div",V,[(0,s._)("div",W,[(0,s._)("div",O,[(0,s.wy)((0,s._)("input",{type:"checkbox",class:"checkbox","onUpdate:modelValue":o[2]||(o[2]=t=>n.data.allIsChoose=t),onClick:o[3]||(o[3]=(...t)=>n.changeAllIsChoose&&n.changeAllIsChoose(...t))},null,512),[[I.e8,n.data.allIsChoose]]),(0,s.Uk)("全选 ")]),(0,s._)("span",{class:"but-delete",onClick:o[4]||(o[4]=t=>n.deleteShop(""))},"删除选中商品"),(0,s._)("div",L,"总价￥"+(0,C.zw)(n.targetShops.sum),1)]),(0,s._)("div",T,[(0,s._)("a",{href:"javascript:;",onClick:o[5]||(o[5]=(...t)=>n.settleAccount&&n.settleAccount(...t))},"结算")])])],64)):(0,s.kq)("",!0),0==n.data.shops?((0,s.wg)(),(0,s.iD)("div",J,[K,(0,s.Wm)(r,{to:"/"},{default:(0,s.w5)((()=>[(0,s.Uk)("点击前往购物")])),_:1})])):(0,s.kq)("",!0)])}e(7658);var F=e(5643),Y=e(4870),R=e(8751),M=e(65),P=e(1120),X=e(7027),G=(e(96),{components:{SmallShopBox:F.Z},setup(){let t=(0,Y.qj)({shops:[],shopIsChoose:[],storeIsChoose:[],allIsChoose:!1}),o=(0,M.oR)();function e(){let e={phone:o.state.user.phone};(0,R.xZ)(e).then((o=>{let e=JSON.parse(o.data);200==e.meta.status&&(t.shops=e.data,t.shops.forEach((o=>{t.shopIsChoose.push(new Array(o.data.length).fill(!1)),t.storeIsChoose.push(!1)})))})).catch((t=>console.log(t)))}e();let n=(0,s.Fl)((()=>{let o=0;return t.shops.forEach((t=>{o+=t.data.length})),o}));function l(o){if(t.shopIsChoose[o].fill(!t.storeIsChoose[o]),t.storeIsChoose[o])t.allIsChoose=!1;else{for(let e=0;e<t.storeIsChoose.length;e++)if(e!=o&&!t.storeIsChoose[e])return;t.allIsChoose=!0}}let a,u=(0,s.Fl)((()=>{let o={sum:0,shopId:[],num:[]},e=t.shopIsChoose,s=t.shops;return e.forEach(((t,e)=>{t.forEach(((t,n)=>{t&&(o.sum=o.sum+s[e].data[n].num*s[e].data[n].price,o.shopId.push(s[e].data[n].shopId),o.num.push(s[e].data[n].num))}))})),o})),r=(0,s.f3)("reload");function c(t){let e=[];if(t)e.push(t);else if(e=u.value.shopId,0==e)return void X.z8.error("当前没有选中商品！");let s={phone:o.state.user.phone,shopId:e};(0,R.jo)(s).then((t=>{let e=JSON.parse(t.data);200===e.meta.status?(X.z8.success(e.meta.msg),(e.data||0===e.data)&&o.commit("user/SET_SHOPCARNUM",e.data),r()):998===e.meta.status&&(X.z8.error(e.meta.msg),r())})).catch((t=>console.log(t)))}function h(){t.storeIsChoose.fill(!t.allIsChoose),t.shopIsChoose.forEach((o=>{o.fill(!t.allIsChoose)}))}function d(o,e){if(t.shopIsChoose[o][e])return t.storeIsChoose[o]=!1,void(t.allIsChoose=!1);let s=t.shopIsChoose;for(let t in s[o])if(t!=e&&!s[o][t])return;t.storeIsChoose[o]=!0;for(let t=0;t<s.length;t++)if(t!==o)for(let o in s[t])if(!s[t][o])return;t.allIsChoose=!0}function p(t){return t=parseInt(t)?parseInt(t):1,t=t<1?1:t,t=t>200?200:t,t}function i(o,e){a&&clearTimeout(a),a=setTimeout((()=>{t.shops[o].data[e].num=p(t.shops[o].data[e].num)}),1e3)}function m(o,e){let s=p(t.shops[o].data[e].num);t.shops[o].data[e].num=s<200?s+1:s}function f(o,e){let s=p(t.shops[o].data[e].num);t.shops[o].data[e].num=s>1?s-1:s}function C(){if(0==u.value.shopId)return void X.z8.error("请选择想要结算的商品！");let t=JSON.stringify({phone:o.state.user.phone,shopId:u.value.shopId,num:u.value.num});(0,R.pj)(t).then((t=>{let e=JSON.parse(t.data);200===e.meta.status&&(X.z8.success("结算成功！"),o.commit("user/SET_SHOPCARNUM",e.data),P.Z.push("/order"))})).catch((t=>console.log(t)))}return{data:t,targetShops:u,totalShops:n,addNum:m,minusNum:f,inspectNum:i,changeIsChoose:l,changeAllIsChoose:h,changeShopIsChoose:d,deleteShop:c,settleAccount:C}}});const Q=(0,i.Z)(G,[["render",B],["__scopeId","data-v-50e7397a"]]);var $=Q,tt=e(8657),ot={components:{TopNav:a.Z,ShopCarHeader:f,ShopsList:$,AppFooter:tt.Z},setup(){document.title="品优购商城-购物车"}};const et=(0,i.Z)(ot,[["render",l]]);var st=et}}]);
//# sourceMappingURL=319.9d29cfaf.js.map